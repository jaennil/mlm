# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–ø–∞–∫–æ–≤–æ–∫ –Ω–∞–ø–∏—Ç–∫–æ–≤

–ü—Ä–æ–µ–∫—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ —É–ø–∞–∫–æ–≤–æ–∫ –Ω–∞–ø–∏—Ç–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º transfer learning –∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `timm`.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–ø–∞–∫–æ–≤–æ–∫ –Ω–∞–ø–∏—Ç–∫–æ–≤:
- **–ñ–µ—Å—Ç—è–Ω–∞—è –±–∞–Ω–∫–∞** (can)
- **–ö–∞—Ä—Ç–æ–Ω–Ω—ã–π —Å—Ç–∞–∫–∞–Ω** (paper_cup)  
- **–ü–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è –±—É—Ç—ã–ª–∫–∞** (plastic_bottle)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fine_tuning/
‚îú‚îÄ‚îÄ app/                          # –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ app.py                   # Gradio –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ model.onnx               # –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ data/                        # –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ raw/                    # –ò—Å—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ can/               # –ñ–µ—Å—Ç—è–Ω—ã–µ –±–∞–Ω–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ paper_cup/         # –ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ —Å—Ç–∞–∫–∞–Ω—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plastic_bottle/    # –ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ processed/             # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train.csv
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ val.csv
‚îÇ   ‚îî‚îÄ‚îÄ README.md              # –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îú‚îÄ‚îÄ fine_tuning/                # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ dataset.py             # –î–∞—Ç–∞—Å–µ—Ç—ã –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ modeling/
‚îÇ       ‚îú‚îÄ‚îÄ train.py           # –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ predict.py         # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
‚îú‚îÄ‚îÄ models/                     # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ best_model.pth
‚îú‚îÄ‚îÄ notebooks/                  # Jupyter —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ experiments.ipynb
‚îú‚îÄ‚îÄ reports/                    # –û—Ç—á–µ—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ figures/
‚îÇ       ‚îú‚îÄ‚îÄ confusion_matrix.png
‚îÇ       ‚îî‚îÄ‚îÄ learning_curves_*.png
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
git clone https://github.com/jaennil/mlm
cd mlm

make create_environment
source .venv/bin/activate

make requirements
```

### üìä –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
–û–±—ä–µ–º: 90 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (30 –Ω–∞ –∫–ª–∞—Å—Å)
–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ: 80% train (72 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), 20% validation (18 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
–ú–µ—Ç–æ–¥ —Å–±–æ—Ä–∞: –ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ä–µ
–§–æ—Ä–º–∞—Ç: PNG, JPG, JPEG, WebP
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
- `data/raw/can/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–µ—Å—Ç—è–Ω—ã—Ö –±–∞–Ω–æ–∫
- `data/raw/paper_cup/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–æ–Ω–Ω—ã—Ö —Å—Ç–∞–∫–∞–Ω–æ–≤
- `data/raw/plastic_bottle/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã—Ö –±—É—Ç—ã–ª–æ–∫

–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞: [data/README.md](data/README.md)

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –û–±—É—á–µ–Ω–∏–µ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (best config - ConvNeXt)
make train

# –û–±—É—á–µ–Ω–∏–µ —Å ResNet34
python train.py --config resnet34

# –û–±—É—á–µ–Ω–∏–µ —Å ConvNeXt
python train.py --config convnext
```

### 4. –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
make app
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:7860`

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π

–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–∞–∫ dataclass –≤ `fine_tuning/config.py`:

### ResNet34
```python
ResNet34Config(
    model_name="resnet34",
    batch_size=16,
    lr=1e-3,
    epochs=12,
    unfreeze_epoch=6
)
```

### ConvNeXt Tiny
```python
ConvNextConfig(
    model_name="convnext_tiny",
    batch_size=8,
    lr=5e-4,
    epochs=15,
    unfreeze_epoch=7
)
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—É—á–µ–Ω–∏—è

1. **–§–∞–∑–∞ 1 (–∑–∞–º–æ—Ä–æ–∑–∫–∞)**:
   - –ó–∞–º–æ—Ä–æ–∂–µ–Ω—ã –≤—Å–µ —Å–ª–æ–∏, –∫—Ä–æ–º–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞

2. **–§–∞–∑–∞ 2 (—Ä–∞–∑–º–æ—Ä–æ–∑–∫–∞)**:
   - –†–∞–∑–º–æ—Ä–æ–∂–µ–Ω—ã –≤—Å–µ —Å–ª–æ–∏ –º–æ–¥–µ–ª–∏
   - Fine-tuning –≤—Å–µ–π —Å–µ—Ç–∏

### –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–æ 224√ó224
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ (p=0.5)
- –ü–æ–≤–æ—Ä–æ—Ç –Ω–∞ 90¬∞ (p=0.5)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ (p=0.3)
- –ì–∞—É—Å—Å–æ–≤—Å–∫–∏–π —à—É–º (p=0.3)
- –≠—Ñ—Ñ–µ–∫—Ç —Ç—É–º–∞–Ω–∞ (p=0.2)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ ImageNet

## üìà –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:

1. **models/best_model.pth** - –≤–µ—Å–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
2. **app/model.onnx** - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
3. **reports/figures/confusion_matrix.png** - –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
4. **reports/figures/learning_curves_*.png** - –∫—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è

## üîç –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:

- ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π random seed (42) –¥–ª—è Python, NumPy, PyTorch
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã PyTorch
- ‚úÖ –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ requirements.txt
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ dataclass

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **PyTorch** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **timm** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- **Albumentations** - –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **ONNX** - —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–¥–µ–ª–µ–π
- **Gradio** - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
- **scikit-learn** - –º–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Pandas** - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
- **Matplotlib/Seaborn** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

## üìù Jupyter Notebook

–í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ `notebooks/experiments.ipynb`:
- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
- –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üéì –í—ã–≤–æ–¥—ã

**ConvNeXt Tiny** –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (100%) –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–ø–∞–∫–æ–≤–æ–∫ –Ω–∞–ø–∏—Ç–∫–æ–≤

–ü—Ä–æ–µ–∫—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ —É–ø–∞–∫–æ–≤–æ–∫ –Ω–∞–ø–∏—Ç–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º transfer learning –∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `timm`.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —É–ø–∞–∫–æ–≤–æ–∫ –Ω–∞–ø–∏—Ç–∫–æ–≤ –Ω–∞ —Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
- **–ñ–µ—Å—Ç—è–Ω–∞—è –±–∞–Ω–∫–∞** (can)
- **–ö–∞—Ä—Ç–æ–Ω–Ω—ã–π —Å—Ç–∞–∫–∞–Ω** (paper_cup)  
- **–ü–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è –±—É—Ç—ã–ª–∫–∞** (plastic_bottle)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç transfer learning —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ (ResNet, ConvNeXt) –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üéØ –ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞

- –°–±–æ—Ä –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (‚â•3 –∫–ª–∞—Å—Å–∞, ‚â•30 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–∫–ª–∞—Å—Å)
- –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º 2 –º–æ–¥–µ–ª–µ–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–µ–º–µ–π—Å—Ç–≤ timm
- Transfer learning —Å —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –∑–∞–º–æ—Ä–æ–∑–∫–∏/—Ä–∞–∑–º–æ—Ä–æ–∑–∫–∏ —Å–ª–æ–µ–≤
- –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π (accuracy, confusion matrix, learning curves)
- –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (—Ñ–∏–∫—Å–∞—Ü–∏—è random seed, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞)
- –≠–∫—Å–ø–æ—Ä—Ç –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –≤ ONNX
- –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Gradio –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fine_tuning/
‚îú‚îÄ‚îÄ app/                          # –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ app.py                   # Gradio –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ model.onnx               # –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ data/                        # –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ raw/                    # –ò—Å—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ can/               # –ñ–µ—Å—Ç—è–Ω—ã–µ –±–∞–Ω–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ paper_cup/         # –ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ —Å—Ç–∞–∫–∞–Ω—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plastic_bottle/    # –ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ processed/             # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train.csv
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ val.csv
‚îÇ   ‚îî‚îÄ‚îÄ README.md              # –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îú‚îÄ‚îÄ fine_tuning/                # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ dataset.py             # –î–∞—Ç–∞—Å–µ—Ç—ã –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ modeling/
‚îÇ       ‚îú‚îÄ‚îÄ train.py           # –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ predict.py         # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
‚îú‚îÄ‚îÄ models/                     # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ best_model.pth
‚îú‚îÄ‚îÄ notebooks/                  # Jupyter —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ experiments.ipynb
‚îú‚îÄ‚îÄ reports/                    # –û—Ç—á–µ—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ figures/
‚îÇ       ‚îú‚îÄ‚îÄ confusion_matrix.png
‚îÇ       ‚îî‚îÄ‚îÄ learning_curves_*.png
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
git clone https://github.com/jaennil/mlm
cd mlm

make create_environment
source .venv/bin/activate

make requirements
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `data/raw/` —Å –ø–æ–¥–ø–∞–ø–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞:
- `data/raw/can/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–µ—Å—Ç—è–Ω—ã—Ö –±–∞–Ω–æ–∫
- `data/raw/paper_cup/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–æ–Ω–Ω—ã—Ö —Å—Ç–∞–∫–∞–Ω–æ–≤
- `data/raw/plastic_bottle/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã—Ö –±—É—Ç—ã–ª–æ–∫

–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞: [data/README.md](data/README.md)

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –û–±—É—á–µ–Ω–∏–µ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (best config - ConvNeXt)
make train

# –û–±—É—á–µ–Ω–∏–µ —Å ResNet34
python train.py --config resnet34

# –û–±—É—á–µ–Ω–∏–µ —Å ConvNeXt
python train.py --config convnext
```

### 4. –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
make app
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:7860`

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π

–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–∞–∫ dataclass –≤ `fine_tuning/config.py`:

### ResNet18 (–±–∞–∑–æ–≤–∞—è)
```python
TrainingConfig(
    model_name="resnet18",
    batch_size=16,
    lr=1e-3,
    epochs=10,
    freeze_backbone=True,
    unfreeze_epoch=5
)
```

### ResNet34
```python
ResNet34Config(
    model_name="resnet34",
    batch_size=16,
    lr=1e-3,
    epochs=12,
    unfreeze_epoch=6
)
```

### ConvNeXt Tiny (–ª—É—á—à–∞—è)
```python
ConvNextConfig(
    model_name="convnext_tiny",
    batch_size=8,
    lr=5e-4,
    epochs=15,
    unfreeze_epoch=7
)
```

## üìä –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | Val Accuracy | –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è |
|--------|-----------|--------------|----------------|
| ResNet18 | 11.2M | ~95% | ~5 –º–∏–Ω |
| ResNet34 | 21.3M | ~97% | ~8 –º–∏–Ω |
| ConvNeXt Tiny | 28.6M | **100%** | ~12 –º–∏–Ω |

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—É—á–µ–Ω–∏—è

1. **–§–∞–∑–∞ 1 (–∑–∞–º–æ—Ä–æ–∑–∫–∞)**:
   - –ó–∞–º–æ—Ä–æ–∂–µ–Ω—ã –≤—Å–µ —Å–ª–æ–∏, –∫—Ä–æ–º–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞

2. **–§–∞–∑–∞ 2 (—Ä–∞–∑–º–æ—Ä–æ–∑–∫–∞)**:
   - –†–∞–∑–º–æ—Ä–æ–∂–µ–Ω—ã –≤—Å–µ —Å–ª–æ–∏ –º–æ–¥–µ–ª–∏
   - Fine-tuning –≤—Å–µ–π —Å–µ—Ç–∏

### –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–æ 224√ó224
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ (p=0.5)
- –ü–æ–≤–æ—Ä–æ—Ç –Ω–∞ 90¬∞ (p=0.5)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ (p=0.3)
- –ì–∞—É—Å—Å–æ–≤—Å–∫–∏–π —à—É–º (p=0.3)
- –≠—Ñ—Ñ–µ–∫—Ç —Ç—É–º–∞–Ω–∞ (p=0.2)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ ImageNet

## üìà –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:

1. **models/best_model.pth** - –≤–µ—Å–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
2. **app/model.onnx** - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
3. **reports/figures/confusion_matrix.png** - –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
4. **reports/figures/learning_curves_*.png** - –∫—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è

## üîç –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:

- ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π random seed (42) –¥–ª—è Python, NumPy, PyTorch
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã PyTorch
- ‚úÖ –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ requirements.txt
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ dataclass
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **PyTorch** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **timm** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- **Albumentations** - –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **ONNX** - —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–¥–µ–ª–µ–π
- **Gradio** - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
- **scikit-learn** - –º–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Pandas** - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
- **Matplotlib/Seaborn** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

## üìù Jupyter Notebook

–í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ `notebooks/experiments.ipynb`:
- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
- –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üéì –í—ã–≤–æ–¥—ã

**ConvNeXt Tiny** –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (100% accuracy) –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
